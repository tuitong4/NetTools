(function(t){function e(e){for(var r,i,s=e[0],c=e[1],l=e[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&f.push(n[i][0]),n[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],r=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=a[0]))}return t}var r={},n={index:0},o=[];function i(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=r,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(a,r,function(e){return t[e]}.bind(null,r));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;o.push([0,"chunk-vendors","chunk-common"]),a()})({0:function(t,e,a){t.exports=a("b635")},"4dfb":function(t,e,a){"use strict";var r=a("754d"),n=a.n(r);n.a},"754d":function(t,e,a){},b635:function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{attrs:{id:"inspire"}},[a("v-navigation-drawer",{attrs:{app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{attrs:{dense:""}},[a("v-list-item",{attrs:{link:""}},[a("v-list-item-action",[a("v-icon",[t._v("mdi-home")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Home")])],1)],1),a("v-list-item",{attrs:{link:""}},[a("v-list-item-action",[a("v-icon",[t._v("mdi-email")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Contact")])],1)],1)],1)],1),a("v-app-bar",{attrs:{app:"",color:"blue",dark:"",elevation:"0"}},[a("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),a("v-toolbar-title",[t._v("NetworkOps")])],1),a("v-main",[a("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[a("netqualitymatrix")],1)],1)],1)},o=[],i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",{attrs:{align:"center"}},[a("v-col",[a("v-menu",{attrs:{transition:"scale-transition","offset-y":"","min-height":"290px","max-height":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on;return[a("v-card-title",[a("div",{staticStyle:{"padding-right":"10px"}},[a("v-icon",[t._v("event")])],1),a("v-datetime-picker",t._g({attrs:{"time-picker-props":t.datetimePickerProps.timeProps,dateFormat:"yyyy-MM-dd","time-format":"HH:mm:ss",label:"选择查询时间"},model:{value:t.queryDateTime,callback:function(e){t.queryDateTime=e},expression:"queryDateTime"}},r))],1)]}}])})],1),a("v-col",[a("v-btn",{on:{click:t.queryQualityData}},[t._v("查询")])],1),a("v-col",{staticClass:"justify-center"},[a("v-switch",{attrs:{label:"禁用自动刷新"},model:{value:t.disalbeAutoResfresh,callback:function(e){t.disalbeAutoResfresh=e},expression:"disalbeAutoResfresh"}})],1)],1),a("v-divider"),a("table",[a("colgroup",t._l(t.dataSets.headers,(function(t,e){return a("col",{key:e,style:{width:0===e?"6em":"3em"}})})),0),a("thead",[a("tr",t._l(t.dataSets.headers,(function(e){return a("th",{key:e,staticClass:"vertical-text"},[t._v(" "+t._s(e)+" ")])})),0)]),"loss"===t.display?a("tbody",t._l(t.dataSets.data,(function(e,r){return a("tr",{key:e["dest"]},t._l(e,(function(n){return a("td",{key:e[n],staticClass:"text-right"},[a("v-chip",{staticClass:"fix-width",attrs:{color:t.getLossColor(n,r),label:"",link:""},on:{click:function(e){return t.goToDetailPage(n)}}},[t._v(" "+t._s(t.formatLoss(n))+" ")])],1)})),0)})),0):a("tbody",{staticClass:"text-right"},t._l(t.dataSets.data,(function(e,r){return a("tr",{key:e.dest},t._l(e,(function(n){return a("td",{key:e[n],staticClass:"text-right"},[a("v-chip",{staticClass:"fix-width",attrs:{color:t.getDelayColor(n,r),label:"",link:""},on:{click:function(e){return t.goToDetailPage(n)}}},[t._v(" "+t._s(t.formatDelay(n))+" ")])],1)})),0)})),0)])],1)},s=[],c=(a("99af"),a("4de4"),a("4160"),a("a630"),a("4ec9"),a("b680"),a("d3b7"),a("6062"),a("3ca3"),a("159b"),a("ddb0"),a("53ca")),l=a("2909"),u=a("fa7d"),d={name:"InternetNetQuality",data:function(){return{netTypeOrder:["Any","BGP","电信","联通","移动","Other"],srcLocationOrder:["BJ03","BJ04","BJ05"],dataSets:{},display:"loss",datetimePickerProps:{timeProps:{useSeconds:!0,format:"24hr"}},disalbeAutoResfresh:!1,queryDateTime:"",autoResfreshTimer:null}},methods:{formatQualityData:function(t){var e=new Set,a=new Set,r=new Set,n=new Set,o=new Map,i=new Map;for(_=0;_<t.length;_++){var s=t[_].value;e.add(s.dstLocation),a.add(s.srcLocation),r.add(s.srcNetType),n.add(s.dstNetType),i.has(s.srcNetType)||i.set(s.srcNetType,new Map);var c=i.get(s.srcNetType);if(c.has(s.srcLocation)){var d=c.get(s.srcLocation);d.packetLoss+=s.packetLoss,d.rtt+=s.rtt,d.count+=s.count}else c.set(s.srcLocation,{srcNetType:s.srcNetType,dstNetType:"Any",srcLocation:s.srcLocation,dstLocation:"Any",rtt:s.rtt,packetLoss:s.packetLoss,count:s.count,lossThreshold:5,rttThreshold:100}),e.add("Any"),n.add("Any");var f=Array(s.dstNetType,s.dstLocation,s.srcNetType,s.srcLocation);Object(u["a"])(o,f,s)}i.forEach((function(t,e){t.forEach((function(t,a){Object(u["a"])(o,Array("Any","Any",e,a),t)}))}));var p=Array.from(e).sort(),h=Array.from(a).sort(),y=new Set(this.netTypeOrder),v=new Set(Object(l["a"])(r).filter((function(t){return y.has(t)}))),m=new Set(Object(l["a"])(r).filter((function(t){return!y.has(t)}))),b=new Array;y.forEach((function(t){v.has(t)&&b.push(t)})),b=b.concat(Array.from(m).sort());var g=this.netTypeOrder,T=new Set(this.srcLocationOrder),w=new Set(Object(l["a"])(a).filter((function(t){return T.has(t)}))),k=new Set(Object(l["a"])(a).filter((function(t){return!T.has(t)}))),A=new Array;T.forEach((function(t){w.has(t)&&A.push(t)})),A=A.concat(Array.from(k).sort());var _,L=Array();for(_=0;_<g.length;_++){var O=g[_];if(o.has(O)){var D,j=o.get(O);for(D=0;D<p.length;D++){var x=p[D];if(j.has(x)){var S,V=j.get(x);for(S=0;S<b.length;S++){var N=b[S];if("Any"===x&&"Any"===O)var C={dest:"地区汇总"};else C={dest:x+O};var P,q=V.get(N);for(P=0;P<h.length;P++){var R=h[P],I=R+"-"+N;if(q.has(R)){var M=q.get(R);M.packetLoss=M["packetLoss"]/M["count"],M.rtt=M["rtt"]/M["count"],C[I]=M}else C[I]={srcNetType:"",dstNetType:"",srcLocation:"",dstLocation:"Any",rtt:-1,packetLoss:-1,count:1,lossThreshold:0,rttThreshold:0}}L.push(C)}}}}}this.dataSets["data"]=L;var Q=Array();b.forEach((function(t){h.forEach((function(e){Q.push(e+"-"+t)}))})),this.dataSets["headers"]=["目标"].concat(Q)},formatLoss:function(t){return"object"===Object(c["a"])(t)&&(t=t.packetLoss.toFixed(0)+"%"),t},formatDelay:function(t){return"object"===Object(c["a"])(t)&&(t=t.rtt.toFixed(1)),t},getLossColor:function(t,e){return"object"===Object(c["a"])(t)?t.packetLoss>t.lossThreshold?"#fd5e53":e%2===0?"#b0eacd":"#7AD6A8":"defualt"},getDelayColor:function(t,e){return"object"===Object(c["a"])(t)?t.rtt>t.rttThreshold?"#fd5e53":e%2===0?"#b0eacd":"#7AD6A8":"defualt"},goToDetailPage:function(t){if("object"===Object(c["a"])(t)){var e=parseInt((new Date).getTime()/1e3),a=e-43200;if("Any"===t.dstLocation&&"Any"===t.dstNetType)var r="/netqualitysummary?srcnettype=".concat(t.srcNetType);else r="/netqualitydetail?srcnettype=".concat(t.srcNetType);r+="&dstnettype=".concat(t.dstNetType),r+="&srclocation=".concat(t.srcLocation),r+="&dstlocation=".concat(t.dstLocation),r+="&starttime=".concat(a),r+="&endtime=".concat(e),window.open(r,"_blank")}},_queryData:function(t){this.$axios.post("/api/netquality",{timestamp:t}).then((function(t){data=t,200==data.code?formatQualityData(data.data):alert(data.message)}))},queryQualityData:function(){this.queryDateTime?(timestamp=parseInt(this.this.queryDateTime.getTime()/1e3),this._queryData(timestamp)):alert("请输入查询时间")},refreshQualityDataAuto:function(){var t=this;null==this.autoResfreshTimer&&(this.autoResfreshTimer=setInterval((function(){t.disalbeAutoResfresh||t._queryData(0)}),3e4))},stopRefreshQualityData:function(){clearInterval(this.autoResfreshTimer),this.autoResfreshTimer=null}},mounted:function(){this._queryData(0),this.refreshQualityDataAuto()},destroyed:function(){this.stopRefreshQualiytData()}},f=d,p=(a("4dfb"),a("2877")),h=a("6544"),y=a.n(h),v=a("8336"),m=a("99d9"),b=a("cc20"),g=a("62ad"),T=a("a523"),w=a("ce7e"),k=a("132d"),A=a("e449"),_=a("0fd9"),L=a("b73d"),O=Object(p["a"])(f,i,s,!1,null,null,null),D=O.exports;y()(O,{VBtn:v["a"],VCardTitle:m["c"],VChip:b["a"],VCol:g["a"],VContainer:T["a"],VDivider:w["a"],VIcon:k["a"],VMenu:A["a"],VRow:_["a"],VSwitch:L["a"]});var j={props:{source:String},data:function(){return{drawer:!1}},components:{netqualitymatrix:D}},x=j,S=a("7496"),V=a("40dc"),N=a("5bc1"),C=a("8860"),P=a("da13"),q=a("1800"),R=a("5d23"),I=a("f6c4"),M=a("f774"),Q=a("2a7f"),E=Object(p["a"])(x,n,o,!1,null,null,null),B=E.exports;y()(E,{VApp:S["a"],VAppBar:V["a"],VAppBarNavIcon:N["a"],VContainer:T["a"],VIcon:k["a"],VList:C["a"],VListItem:P["a"],VListItemAction:q["a"],VListItemContent:R["a"],VListItemTitle:R["b"],VMain:I["a"],VNavigationDrawer:M["a"],VToolbarTitle:Q["a"]});var J=a("402c"),$=a("ad24"),F=(a("d1e78"),a("bc3a")),H=a.n(F);r["a"].use($["a"]),r["a"].config.productionTip=!1,r["a"].prototype.$axios=H.a,new r["a"]({vuetify:J["a"],icons:{iconfont:"md"},render:function(t){return t(B)}}).$mount("#app")}});
//# sourceMappingURL=index.87ef3fd0.js.map